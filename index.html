function loadData() {
            try {
                const saved = localStorage.getItem(STORAGE_KEY);
                if (saved) {
                    const data = JSON.parse(saved);
                    if (data && Array.isArray(data.accounts)) {
                        data.accounts.forEach(acc => {
                            if (!acc.challenges) acc.challenges = [];
                            if (!acc.history) acc.history = [];
                            
                            // データマイグレーション: 旧形式の acc.coins を最初のチャレンジに統合
                            if (typeof acc.coins === 'number') {
                                if (acc.challenges.length === 0) {
                                    acc.challenges.push({ 
                                        name: 'お手伝い', 
                                        value: 10, 
                                        coins: acc.coins, 
                                        totalCoins: acc.coins 
                                    });
                                } else {
                                    const firstChallenge = acc.challenges[0];
                                    firstChallenge.coins = (firstChallenge.coins || 0) + acc.coins;
                                    firstChallenge.totalCoins = (firstChallenge.totalCoins || 0) + acc.coins;
                                }
                                delete acc.coins;
                            }
                            
                            // チャレンジが空の場合はデフォルトを作成
                            if (acc.challenges.length === 0) {
                                acc.challenges.push({ 
                                    name: 'お手伝い', 
                                    value: 10, 
                                    coins: 0, 
                                    totalCoins: 0 
                                });
                            }
                            
                            // 各チャレンジのプロパティを初期化
                            acc.challenges.forEach(c => {
                                if (typeof c.coins !== 'number') c.coins = 0;
                                if (typeof c.totalCoins !== 'number') c.totalCoins = 0;
                                if (typeof c.value !== 'number' || c.value < 1) c.value = 10;
                                if (!c.name || c.name.trim() === '') c.name = '無名チャレンジ';
                            });
                        });
                        appData = data;
                        return;
                    }
                }
                // 初期データの作成
                initializeDefaultData();
            } catch (e) {
                console.error('読み込みエラー:', e);
                initializeDefaultData();
            }
        }
        
        function initializeDefaultData() {
            if (appData.accounts.length === 0) {
                appData.accounts.push({
                    name: "こども1",
                    history: [],
                    challenges: [
                        { name: "お手伝い", value: 10, coins: 0, totalCoins: 0 },
                        { name: "テスト", value: 5, coins: 0, totalCoins: 0 }
                    ]
                });
            }
        }
                                    
